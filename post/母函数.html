<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<title>浅谈母函数 - blue's blog</title>

	<!-- css -->
	<link href="/css/base.min.css" rel="stylesheet">
	<link href="/css/project.min.css" rel="stylesheet">
	<link href="/css/styles.css" rel="stylesheet">


	<script type="text/x-mathjax-config">
  		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body class="page-brand">
	
	<nav class="menu menu-left nav-drawer nav-drawer-md" id="ui_menu">
		<div class="menu-scroll">
			<div class="menu-content">
				<a class="menu-logo" href="/">blue的博客</a>
				<ul class="nav">
					<li>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#posts">OI笔记</a>	
						<ul class="menu-collapse collapse in" id="posts">
							
							<li>
								<a class="waves-attach" href="/post/特征方程.html">特征方程教程</a>
							</li><li>
								<a class="waves-attach" href="/post/近似算法.html">近似算法</a>
							</li><li>
								<a class="waves-attach" href="/post/SG函数.html">SG函数</a>
							</li><li>
								<a class="waves-attach" href="/post/Matrix-Tree.html">Matrix-Tree定理</a>
							</li><li>
								<a class="waves-attach" href="/post/polya.html">polya定理</a>
							</li><li>
								<a class="waves-attach" href="/post/NOIP2016.html">NOIP2016游记</a>
							</li><li>
								<a class="waves-attach" href="/post/有限微积分.html">差分与有限微积分</a>
							</li><li>
								<a class="waves-attach" href="/post/概率论.html">概率论</a>
							</li><li>
								<a class="waves-attach" href="/post/博弈论.html">博弈论入门</a>
							</li><li>
								<a class="waves-attach" href="/post/级数相关.html">级数相关</a>
							</li><li class="active">
								<a class="waves-attach" href="/post/母函数.html">浅谈母函数</a>
							</li><li>
								<a class="waves-attach" href="/post/FFT.html">FFT入门</a>
							</li><li>
								<a class="waves-attach" href="/post/三分查找.html">三分查找</a>
							</li><li>
								<a class="waves-attach" href="/post/Miller_Rabin.html">Miller_Rabin判素</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round4酱油记.html">HNSDFZ#4 酱油记</a>
							</li><li>
								<a class="waves-attach" href="/post/牛顿迭代.html">牛顿迭代法</a>
							</li><li>
								<a class="waves-attach" href="/post/泰勒展开.html">泰勒展开</a>
							</li><li>
								<a class="waves-attach" href="/post/狄利克雷卷积.html">狄利克雷卷积</a>
							</li><li>
								<a class="waves-attach" href="/post/单调队列.html">单调队列</a>
							</li><li>
								<a class="waves-attach" href="/post/数值积分算法.html">数值积分算法</a>
							</li><li>
								<a class="waves-attach" href="/post/字符串hash.html">字符串hash</a>
							</li><li>
								<a class="waves-attach" href="/post/MEET-IN-THE-MIDDLE.html">Meet in the Middle</a>
							</li><li>
								<a class="waves-attach" href="/post/定积分.html">定积分与牛顿-莱布尼兹公式</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round3胡策记.html">HNSDFZ#3 胡策记</a>
							</li><li>
								<a class="waves-attach" href="/post/数学归纳法.html">数学归纳法</a>
							</li><li>
								<a class="waves-attach" href="/post/导数.html">导数</a>
							</li><li>
								<a class="waves-attach" href="/post/普通线段树.html">普通线段树</a>
							</li><li>
								<a class="waves-attach" href="/post/矩阵与递推.html">矩阵与递推</a>
							</li>						</ul>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#hack">渗透日志</a>	
						<ul class="menu-collapse collapse in" id="hack">
							
							<li>
								<a class="waves-attach" href="/hack/XSS.html">初探XSS</a>
							</li>						</ul>

					</li>
					
				</ul>
			</div>
		</div>
	</nav>
	<header class="header header-transparent header-waterfall ui-header">
		<ul class="nav nav-list pull-left hidden-md hidden-lg">
			<li>
				<a data-toggle="menu" href="#ui_menu">
					<span class="icon icon-lg">menu</span>
				</a>
			</li>
		</ul>
		<span class="header-logo header-affix visible-md-block visible-lg-block margin-right-no" data-offset-top="0" data-spy="affix">
			<p class="pagetitle">浅谈母函数</p>
		</span>
		
		<ul class="nav nav-list pull-right">
			<li>
				<a data-toggle="menu" href="/">
					<span class="avatar avatar-sm"><img alt="blue" src="https://i.loli.net/2017/10/21/59eb6654682d2.png"></span>
				</a>
			</li>
		</ul>
	</header>
	<main class="content">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<br>
						
<h1>浅谈母函数</h1>
<div class="card"><div class="card-main"><div class="card-inner">
<p>母函数真是迷人……</p>
</div></div></div>
<h2>定义</h2>
<p>母函数是一个<strong>无穷级数</strong>：<mathjax>$\displaystyle G(x)=g_0+g_1x+g_2x^2+\cdots=\sum_{i=0}^\infty g_ix^i$</mathjax></p>
<p>我们把系数<mathjax>$g_0,g_1\cdots$</mathjax>提取出来，这个系数序列与母函数存在<strong>一一对应</strong>的关系，存在双射：<mathjax>$\vec{g} \leftrightarrow G(x)$</mathjax>.</p>
<p>举个例子，有母函数<mathjax>$G(x)=1+x+x^2+x^3\cdots$</mathjax>，则与之对应的系数表达就是<mathjax>$&lt;1,1,1,1\cdots&gt;$</mathjax>.</p>
<h2>基本运算</h2>
<p>加减<br />
<mathjax>$F(x)+G(x) \leftrightarrow &lt;f_0+g_0,f_1+g_1,f_2+g_2\cdots&gt;$</mathjax><br />
<mathjax>$F(x)-G(x) \leftrightarrow &lt;f_0-g_0,f_1-g_1,f_2-g_2\cdots&gt;$</mathjax>  </p>
<p>数乘<br />
<mathjax>$c*G(x) \leftrightarrow &lt;c*g_0,c*g_1,c*g_2\cdots&gt;$</mathjax></p>
<p>乘幂<br />
<mathjax>$x^k*G(x)\leftrightarrow&lt;0,0\cdots,0,g_0,g_1\cdots&gt;$</mathjax>（前面放上<mathjax>$k$</mathjax>个<mathjax>$0$</mathjax>）</p>
<p><strong>卷积</strong><br />
<mathjax>$F(x) \times G(x)$</mathjax>，跑FFT做多项式乘法即可。</p>
<h2>用处</h2>
<p>这里介绍最简单的用途。</p>
<p>你有一些水果，只能拿<strong>3的倍数</strong>个苹果，只能拿<strong>质数个</strong>草莓。问<strong>对于每个<mathjax>$0&lt;i&lt;=n$</mathjax></strong>，有多少种方案使得恰好拿<mathjax>$i$</mathjax>个水果。  </p>
<p>我们不妨先造出两个布尔数组，来储存“能不能拿”。<br />
苹果：<code>[0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1...]</code><br />
草莓：<code>[0,0,1,1,0,1,0,1,0,0,0,1,0,1,0,0...]</code>  </p>
<p>考虑母函数。我们尝试用<mathjax>$x^k$</mathjax>的系数来表示<strong>取<mathjax>$k$</mathjax>个物品的方案数</strong>。那么上面的两个布尔数组生成了两个母函数：</p>
<p>苹果：<mathjax>$A(x)=x^3+x^6+x^9\cdots$</mathjax><br />
草莓：<mathjax>$B(x)=x^2+x^3+x^5+x^7\cdots$</mathjax>  </p>
<p>我们把它们乘起来，就会发现一个奇妙的事情：乘积的结果，<mathjax>$x^k$</mathjax>的系数正好表示了取<mathjax>$k$</mathjax>个物品的方案数。</p>
<p>为什么会这样？考虑<mathjax>$x^5$</mathjax>的系数。<mathjax>$x^5$</mathjax>可以由<mathjax>$x^0*x^5,x^1*x^4,x^2*x^3,x^3*x^2\cdots$</mathjax>来构成，这正好映射了“0个苹果5个草莓、1个苹果4个草莓……”的选取方式。</p>
<p>结合FFT，我们就可以在<mathjax>$O(n \log n)$</mathjax>的时间复杂度内求出<mathjax>$0&lt;i&lt;=n$</mathjax>的答案。直接输出卷积即可。</p>
<p>高级运算：<strong>求导</strong>  <br />
母函数可以求导。效果是把系数左移一位，然后乘上次数。<br />
<mathjax>$G(x)\space \space \leftrightarrow \space &lt;g_0,g_1,g_2,g_3\cdots&gt;$</mathjax><br />
<mathjax>$G'(x)\space \leftrightarrow \space &lt;g_1,2g_2,3g_3\cdots&gt;$</mathjax>  </p>
<h2>闭形式</h2>
<p>考虑母函数<mathjax>$&lt;1,1,1\cdots&gt;$</mathjax>，对其进行等比数列求和： <br />
<mathjax>$\displaystyle 1+x+x^2+x^3\cdots = \frac{1}{1-x}$</mathjax>  </p>
<p>我们称<mathjax>$\frac{1}{1-x}$</mathjax>为母函数<mathjax>$&lt;1,1,1\cdots&gt;$</mathjax>的<code>闭形式</code>。<br />
<strong>注意，这里忽略了收敛问题。但是这没有影响，因为我们需要使用的是系数，与<mathjax>$x$</mathjax>的取值始终无关。</strong></p>
<p>对母函数的操作等价于对闭形式的操作。例如，我们对<mathjax>$&lt;1,1,1\cdots&gt;$</mathjax>求导：<br />
<mathjax>$\displaystyle G(x)=\frac{1}{1-x}$</mathjax> <br />
<mathjax>$\displaystyle G'(x)=\frac{1}{(1-x)^2}$</mathjax>  </p>
<p>又<mathjax>$G'(x) \leftrightarrow &lt;1,2,3\cdots&gt;$</mathjax>（之前已经算出过）  </p>
<p>故有结论：<mathjax>$\displaystyle \frac{1}{(1-x)^2} \leftrightarrow &lt;1,2,3\cdots&gt;$</mathjax>.  </p>
<h2>例题</h2>
<p>论文题。</p>
<p>明明这次又要出去旅游了，和上次不同的是，他这次要去宇宙探险！</p>
<p>我们暂且不讨论他有多么NC，他又幻想了他应该带一些什么东西。理所当然的，你当然要帮他计算携带N件物品的方案数。</p>
<p>他这次又准备带一些受欢迎的食物，如：蜜桃多啦，鸡块啦，承德汉堡等等。<br />
当然，他又有一些稀奇古怪的限制：  </p>
<p>每种食物的限制如下：  </p>
<div class="card"><div class="card-main"><div class="card-inner">
<p>最多带 1 个汉堡<br />
巧克力的块数是 5 的倍数<br />
最多带 4 瓶矿泉水<br />
薯片的包数是一个偶数<br />
最多带 3 罐牛奶<br />
糖果的个数是 4 的倍数  </p>
</div></div></div>
<p>注意，这里我们懒得考虑明明对于带的食物该怎么搭配着吃，也认为每种食物都是以‘个’为单位（反正是幻想嘛），只要总数加起来是<mathjax>$n$</mathjax>就算一种方案。因此，对于给出的<mathjax>$n$</mathjax>,你需要计算出方案数，并对<mathjax>$10007$</mathjax>取模。<mathjax>$n&lt;=10^{100}$</mathjax>，<mathjax>$k&lt;=3$</mathjax>。</p>
<p>我们考虑为每个限制生成自己的母函数。像前面的例子一样，<mathjax>$0$</mathjax>代表可选择，<mathjax>$1$</mathjax>代表不可选择。  <br />
汉堡：<mathjax>$&lt;1,1,0,0,0,0\cdots&gt; \leftrightarrow 1+x$</mathjax><br />
(只能带<mathjax>$0$</mathjax>或<mathjax>$1$</mathjax>个) <br />
巧克力：<mathjax>$&lt;1,0,0,0,0,1,0,0,\cdots&gt; \leftrightarrow \frac{1}{1-x^5}$</mathjax><br />
(<mathjax>$5$</mathjax>的倍数)  <br />
矿泉水：<mathjax>$&lt;1,1,1,1,1,0,0\cdots&gt; \leftrightarrow \frac{1-x^5}{1-x}$</mathjax><br />
(最多<mathjax>$4$</mathjax>瓶)<br />
薯片：<mathjax>$&lt;1,0,1,0,1\cdots&gt; \leftrightarrow \frac{1}{1-x^2}$</mathjax><br />
(偶数个)<br />
牛奶：<mathjax>$&lt;1,1,1,1,0,0\cdots&gt; \leftrightarrow \frac{1-x^4}{1-x}$</mathjax> <br />
(最多<mathjax>$3$</mathjax>罐)<br />
糖果：<mathjax>$&lt;1,0,0,0,1,0\cdots&gt; \leftrightarrow \frac{1}{1-x^4   }$</mathjax><br />
(<mathjax>$4$</mathjax>的倍数)  </p>
<p>直接卷起来，最后结果化简为<mathjax>$\displaystyle \frac{1}{(1-x)^3} = (\frac{1}{1-x})^3\leftrightarrow &lt;1,1,1,1,1\cdots&gt;^3$</mathjax>。</p>
<p>容易用二项式定理把它重新搞成系数形式：<mathjax>$1+C^2_3x+C^2_4x^2+C^2_5x^3\cdots$</mathjax></p>
<p>题目需要求的是<mathjax>$x^n$</mathjax>的系数，直接输出<mathjax>$C_{n+2}^2$</mathjax>即得解。</p>
<h2>指数型母函数</h2>
<p>泰勒展开相关。留坑待补。  </p>
<hr />
<p>Update on 2016.8.30</p>
<p>此坑已补。</p>
<hr />
<p>Update on 2016.10.3</p>
<p>修正了一些错误。</p>
						
					</section>
				</div>
			</div>

			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<hr>
						
							CC0协议 @ ruanxingzhi 2017.
						<a style="float:right" href="/CC0.html">CC0是啥玩意?</a>
					</section>
				</div>
			</div>

			<!-- UY BEGIN -->
			<div id="uyan_frame"></div>
			<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128300"></script>
			<!-- UY END -->


		</div>


	</main>
	
	<div class="fbtn-container">
		<div class="fbtn-inner">
			<a class="fbtn fbtn-lg fbtn-brand-accent waves-attach waves-circle waves-light" data-toggle="dropdown">
				<span class="fbtn-text fbtn-text-left">Home</span>
				<span class="fbtn-ori icon">apps</span>
				<span class="fbtn-sub icon">close</span>
			</a>
			<div class="fbtn-dropup">
				<a class="fbtn waves-attach waves-circle" href="/about.html" target="_blank">
					<span class="fbtn-text fbtn-text-left">关于作者</span><span class="icon">perm_identity</span>
				</a>
				<a class="fbtn waves-attach waves-circle" href="https://coding.net/u/ruanxingzhi/p/blog/topic" target="_blank">
					<span class="fbtn-text fbtn-text-left">反馈</span><span class="icon">feedback</span>
				</a>
				<a class="fbtn fbtn-green waves-attach waves-circle" href="/" target="_self">
					<span class="fbtn-text fbtn-text-left">返回主页</span><span class="icon">home</span>
				</a>
			</div>
		</div>
	</div>

	

	<!-- js -->
	<script src="/js/jquery.min.js"></script>
	<script src="/js/base.min.js"></script>
</body>
</html>