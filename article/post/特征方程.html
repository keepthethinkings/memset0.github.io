<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<title>特征方程教程 - blue's blog</title>

	<!-- css -->
	<link href="/css/base.min.css" rel="stylesheet">
	<link href="/css/project.min.css" rel="stylesheet">
	<link href="/css/styles.css" rel="stylesheet">


	<script type="text/x-mathjax-config">
  		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body class="page-brand">
	
	<nav class="menu menu-left nav-drawer nav-drawer-md" id="ui_menu">
		<div class="menu-scroll">
			<div class="menu-content">
				<a class="menu-logo" href="/">blue的博客</a>
				<ul class="nav">
					<li>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#posts">OI笔记</a>	
						<ul class="menu-collapse collapse in" id="posts">
							
							<li class="active">
								<a class="waves-attach" href="/post/特征方程.html">特征方程教程</a>
							</li><li>
								<a class="waves-attach" href="/post/近似算法.html">近似算法</a>
							</li><li>
								<a class="waves-attach" href="/post/SG函数.html">SG函数</a>
							</li><li>
								<a class="waves-attach" href="/post/Matrix-Tree.html">Matrix-Tree定理</a>
							</li><li>
								<a class="waves-attach" href="/post/polya.html">polya定理</a>
							</li><li>
								<a class="waves-attach" href="/post/NOIP2016.html">NOIP2016游记</a>
							</li><li>
								<a class="waves-attach" href="/post/有限微积分.html">差分与有限微积分</a>
							</li><li>
								<a class="waves-attach" href="/post/概率论.html">概率论</a>
							</li><li>
								<a class="waves-attach" href="/post/博弈论.html">博弈论入门</a>
							</li><li>
								<a class="waves-attach" href="/post/级数相关.html">级数相关</a>
							</li><li>
								<a class="waves-attach" href="/post/母函数.html">浅谈母函数</a>
							</li><li>
								<a class="waves-attach" href="/post/FFT.html">FFT入门</a>
							</li><li>
								<a class="waves-attach" href="/post/三分查找.html">三分查找</a>
							</li><li>
								<a class="waves-attach" href="/post/Miller_Rabin.html">Miller_Rabin判素</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round4酱油记.html">HNSDFZ#4 酱油记</a>
							</li><li>
								<a class="waves-attach" href="/post/牛顿迭代.html">牛顿迭代法</a>
							</li><li>
								<a class="waves-attach" href="/post/泰勒展开.html">泰勒展开</a>
							</li><li>
								<a class="waves-attach" href="/post/狄利克雷卷积.html">狄利克雷卷积</a>
							</li><li>
								<a class="waves-attach" href="/post/单调队列.html">单调队列</a>
							</li><li>
								<a class="waves-attach" href="/post/数值积分算法.html">数值积分算法</a>
							</li><li>
								<a class="waves-attach" href="/post/字符串hash.html">字符串hash</a>
							</li><li>
								<a class="waves-attach" href="/post/MEET-IN-THE-MIDDLE.html">Meet in the Middle</a>
							</li><li>
								<a class="waves-attach" href="/post/定积分.html">定积分与牛顿-莱布尼兹公式</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round3胡策记.html">HNSDFZ#3 胡策记</a>
							</li><li>
								<a class="waves-attach" href="/post/数学归纳法.html">数学归纳法</a>
							</li><li>
								<a class="waves-attach" href="/post/导数.html">导数</a>
							</li><li>
								<a class="waves-attach" href="/post/普通线段树.html">普通线段树</a>
							</li><li>
								<a class="waves-attach" href="/post/矩阵与递推.html">矩阵与递推</a>
							</li>						</ul>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#hack">渗透日志</a>	
						<ul class="menu-collapse collapse in" id="hack">
							
							<li>
								<a class="waves-attach" href="/hack/XSS.html">初探XSS</a>
							</li>						</ul>

					</li>
					
				</ul>
			</div>
		</div>
	</nav>
	<header class="header header-transparent header-waterfall ui-header">
		<ul class="nav nav-list pull-left hidden-md hidden-lg">
			<li>
				<a data-toggle="menu" href="#ui_menu">
					<span class="icon icon-lg">menu</span>
				</a>
			</li>
		</ul>
		<span class="header-logo header-affix visible-md-block visible-lg-block margin-right-no" data-offset-top="0" data-spy="affix">
			<p class="pagetitle">特征方程教程</p>
		</span>
		
		<ul class="nav nav-list pull-right">
			<li>
				<a data-toggle="menu" href="/">
					<span class="avatar avatar-sm"><img alt="blue" src="https://i.loli.net/2017/10/21/59eb6654682d2.png"></span>
				</a>
			</li>
		</ul>
	</header>
	<main class="content">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<br>
						
<h1>特征方程教程</h1>
<p>我们常常会遇到一些递推式，例如著名的斐波那契数列：<mathjax>$F_{n+2}=F_n+F_{n+1} (F_1=1,F_2=1)$</mathjax>.在这种情况下，往往难以推出通项。</p>
<p>如果我们要编程求<mathjax>$F_n$</mathjax>，只需要矩阵快速幂就行了——可以在<mathjax>$O(\log n)$</mathjax>的时间复杂度内求出答案。有没有更“数学”的解法，来求出通项公式呢？</p>
<p>我们尝试用一种叫做“特征方程”的科技，来解决这类问题。实际上，这玩意很简单，个中原理也不复杂。（有公式恐惧症的不要跑呀，这篇文章没几个公式的）</p>
<h2>找规律</h2>
<p>首先我们来看一个漂亮的例子：<mathjax>$a_{n+2}=5\cdot a_{n+1}-6\cdot a_n$</mathjax><br />
真是让人摸不着头脑？那么现在给出一个已知条件：<mathjax>$f_n=2^{n-1}$</mathjax>这个数列满足上述递推式。</p>
<p><mathjax>$\{1,2,4,8,16\cdots \}$</mathjax>，代入一看，果然。</p>
<p>有没有更一般的规律？我们来发掘一下……<br />
<mathjax>$\{3\cdot f_n\} = \{3,6,12,24,48\cdots\}$</mathjax><br />
这个数列也满足递推式！</p>
<p>多找几个例子，我们注意到一个事实：<strong>若等比数列<mathjax>$\{f_n\}$</mathjax>满足递推式，那么<mathjax>$\{\lambda \cdot f_n\}$</mathjax>也满足递推式。</strong></p>
<p>证明：把原递推式两边都乘上<mathjax>$\lambda$</mathjax>就行了，不碍事。</p>
<h2>另一个真相</h2>
<p>现在告诉您另一个事实：<mathjax>$g_n=3^{n-1}$</mathjax>这个等比数列，竟然也满足原递推式。</p>
<p>不信么？<mathjax>$\{g_n\}=\{1,3,9,27,81\cdots\}$</mathjax><br />
代入，发现真的也行！</p>
<p>根据我们刚刚的结论，<mathjax>$\{\lambda \cdot g_n\}$</mathjax>也是满足递推式的。能不能把<mathjax>$f$</mathjax>和<mathjax>$g$</mathjax>综合起来呢？</p>
<p><mathjax>$\{3f_n + 5g_n\} = \{8,21,57,159\cdots\}$</mathjax>满足条件。<br />
<mathjax>$\{7f_n+2g_n\} = \{9,20,46,110\cdots\}$</mathjax>满足条件。<br />
……  </p>
<p>现在我们得到了强化的结论：如果等比数列<mathjax>$\{ f_n\},\{ g_n\}$</mathjax>分别满足递推式，那么<mathjax>$\{\alpha f_n+\beta g_n\}$</mathjax>也满足递推式。证明很简单。</p>
<h2>形而上</h2>
<p>形而上者谓之道，形而下者谓之器。上面的例子是特殊的，我们试图给出一些一般性的结论：</p>
<p>现有递推式<mathjax>$f_{n}+p_{k-1}f_{n-1}+p_{k-2}f_{n-2}+\cdots+p_{0}f_{n-k}=0$</mathjax>,称为<mathjax>$k$</mathjax>阶线性<strong>齐次</strong>递推方程。<br />
这只是把原来的递推式换了个写法，例如斐波那契数列：<mathjax>$f_n-f_{n-1}-f_{n-2}=0$</mathjax></p>
<p>我们刚刚发现：如果已知数列<mathjax>$\{a_n\},\{b_n\},\{c_n\}  \cdots$</mathjax>都满足这个递推式，那么它们的“线性组合”<mathjax>$\{\alpha \cdot a_n + \beta \cdot b_n + \gamma \cdot c_n\cdots\}$</mathjax>也满足递推式。</p>
<p>将<mathjax>$\{a_n\},\{b_n\}\cdots$</mathjax>称作此递推方程的解。</p>
<p>依据这个结论，我们只需要知道一组解<mathjax>$\{a_n\},\{b_n\}\cdots$</mathjax>，我们就可以拼凑出各种各样的数列，满足递推关系。但是需要指出：</p>
<p>如果解<mathjax>$\{b_n\}$</mathjax>可以通过解<mathjax>$\{a_n\}$</mathjax>直接得到，那么<mathjax>$\{b_n\}$</mathjax>的存在就是无意义的了。  <br />
如果解<mathjax>$\{c_n\}$</mathjax>可以通过解<mathjax>$\{a_n\},\{b_n\}$</mathjax>直接得到，那么<mathjax>$\{c_n\}$</mathjax>的存在也没有意义了。</p>
<p>打个比方：对于二元一次方程组，如果我们知道<mathjax>$x+y=2$</mathjax>，那么<mathjax>$2x+2y=4$</mathjax>这个方程就是毫无用处的。  </p>
<p>因此，这里的<mathjax>$\{a_n\},\{b_n\}\cdots$</mathjax>，其实和向量的基底比较类似——如果<mathjax>$\{a_n\},\{b_n\}\cdots$</mathjax>是“线性无关”的，那么我们就可以通过<mathjax>$\{a_n\},\{b_n\}\cdots$</mathjax>拼凑出每一个合法的数列。  </p>
<h2>实际操作</h2>
<p>通过刚刚的讨论，我们发现一个基本事实：拿到一个递推式，如果我们能求出它的一组解，还知道<mathjax>$f_n$</mathjax>的前几项——我们就能推出数列的通项公式。  </p>
<p>还是以<mathjax>$a_{n+2}=5\cdot a_{n+1}-6\cdot a_n$</mathjax>为例。我们找到了一组解：
<mathjax>$f_n=2^{n-1},g_n=3^{n-1}$</mathjax>  </p>
<p>根据之前的结论，可以令<mathjax>$a_n=\alpha 2^{n-1} + \beta 3^{n-1}$</mathjax>.  </p>
<p>而我们现在又知道<mathjax>$f_1=3,f_2=8$</mathjax>。遂直接代入柿子：<br />
<mathjax>$\begin{equation}
  \left\{
   \begin{aligned}
   \alpha + \beta = 3  \\
   2\alpha +  3\beta = 8
   \end{aligned}
   \right.
  \end{equation}$</mathjax></p>
<p>解出<mathjax>$\alpha = 1,\beta = 2$</mathjax>.也就是说，<mathjax>$a_n = 2^{n-1}+2\cdot 3^{n-1}$</mathjax>.
而根据通项公式算出来的前几项是：<mathjax>$\{3,8,22,62\cdots\}$</mathjax>，检验一下，发现确实是吻合的。</p>
<h2>特征方程</h2>
<p>我们刚刚求出了通项公式，关键在于我们凭空得知了一个结论：<mathjax>$\{f_n\},\{g_n\}$</mathjax>满足递推式。然而天上并不会掉馅饼，我们以后拿到一个递推式，总不可能乞灵于一眼看出来一组解吧？</p>
<p>毛主席教导我们：自己动手，丰衣足食。我们要自己构造出一组解！</p>
<p>如何构造这一组解？通过刚刚的讨论，我们认为构造等比数列比较靠谱。那么我们不妨令以<mathjax>$q$</mathjax>为公比的等比数列满足<mathjax>$a_{n+2}=5\cdot a_{n+1}-6\cdot a_n$</mathjax>，那么柿子变成：<br />
<mathjax>$q^2\cdot a_n=5q \cdot a_n-6\cdot a_n$</mathjax><br />
两边除以<mathjax>$a_n$</mathjax>：<br />
<mathjax>$q^2 = 5q - 6$</mathjax>，即<mathjax>$q^2-5q+6=0$</mathjax>，即<mathjax>$q=2$</mathjax>或<mathjax>$3$</mathjax>。  </p>
<p>也就是说：凡是以<mathjax>$2$</mathjax>或<mathjax>$3$</mathjax>为公比的等比数列，都满足这个递推式。因此我们自己构造出了两组解：<mathjax>$f_n=2^{n-1},g_n=3^{n-1}$</mathjax>。</p>
<p>一般地：对于长得像上面递推式的柿子，以<mathjax>$x^p$</mathjax>代替<mathjax>$a_{n+p}$</mathjax>，得到的方程称作“特征方程”。</p>
<p>例如： 
<mathjax>$a_{n+2}=a_{n+1}+2*a_n$</mathjax>的特征方程是：<mathjax>$x^2=x+2$</mathjax><br />
<mathjax>$a_{n+3}=5*a_{n+2}+3*a_{n+1}+a_n$</mathjax>的特征方程是：<mathjax>$x^3=5x^2+3x+1$</mathjax>  </p>
<p>解特征方程，得到的根就可以作为等比数列的公比。</p>
<h2>习题</h2>
<p>一、求斐波那契数列的通项公式：</p>
<p><mathjax>$f_{n+2}=f_{n+1}+f_n$</mathjax>，特征方程为<mathjax>$x^2=x+1$</mathjax>.<br />
解得：<mathjax>$x_1 = \frac{1-\sqrt{5}}{2},x_2 = \frac{1+\sqrt{5}}{2}$</mathjax>  </p>
<p>不妨设<mathjax>$f_n = \alpha (x_1)^{n-1} + \beta(x_2)^{n-1}$</mathjax>.又已知<mathjax>$f_1=1,f_2=1$</mathjax>，代入则有：<br />
<mathjax>$\alpha + \beta = 1$</mathjax><br />
<mathjax>$\frac{1-\sqrt{5}}{2}\alpha +  \frac{1+\sqrt{5}}{2}\beta = 1$</mathjax>  </p>
<p>解得：<mathjax>$\alpha = \frac{\sqrt{5}-1}{2\sqrt{5}},\beta =   \frac{\sqrt{5}+1}{2\sqrt{5}}$</mathjax></p>
<p>代入原柿子，即得：<mathjax>$f_n = \frac{\sqrt{5}-1}{2\sqrt{5}}(\frac{1-\sqrt{5}}{2})^{n-1} + \frac{\sqrt{5}+1}{2\sqrt{5}}(\frac{1+\sqrt{5}}{2})^{n-1}$</mathjax>  </p>
<p>整理，得：<mathjax>$f_n=\frac{1}{\sqrt{5}}[(\frac{1+\sqrt{5}}{2})^n-\frac{1-\sqrt{5}}{2})^n]$</mathjax>.</p>
<p>二、NOIP2017提高组初赛，T10</p>
<p>若<mathjax>$f_0=0,f_1=1,f_{n+1}=\frac{f_{n}+f_{n-1}}{2}$</mathjax>,则随着<mathjax>$i$</mathjax>的增大，<mathjax>$f_i$</mathjax>将接近于（）。  </p>
<p><code>A.</code> <mathjax>$\frac{1}{2}$</mathjax> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>B.</code> <mathjax>$\frac{2}{3}$</mathjax>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <code>C.</code> <mathjax>$\frac{\sqrt{5}-1}{2}$</mathjax> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<code>D.</code> <mathjax>$1$</mathjax></p>
<p>特征方程：<mathjax>$x^2 = \frac{x+1}{2}$</mathjax>，解得<mathjax>$x_1=-\frac{1}{2},x_2=1$</mathjax>.<br />
不妨设<mathjax>$f_n=\alpha\cdot (-\frac{1}{2})^n + \beta$</mathjax>.</p>
<p>代入<mathjax>$f_0=0,f_1=1$</mathjax>，得：<mathjax>$\alpha = -\frac{2}{3},\beta = \frac{2}{3}$</mathjax>.<br />
故：<mathjax>$f_n = -\frac{2}{3}\cdot (-\frac{1}{2})^n + \frac{2}{3}$</mathjax>.</p>
<p>显然，<mathjax>$\displaystyle \lim_{n \to +\infty}   f(n)=\frac{2}{3}$</mathjax>，此题选B。  </p>
						
					</section>
				</div>
			</div>

			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<hr>
						
							CC0协议 @ ruanxingzhi 2017.
						<a style="float:right" href="/CC0.html">CC0是啥玩意?</a>
					</section>
				</div>
			</div>

			<!-- UY BEGIN -->
			<div id="uyan_frame"></div>
			<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128300"></script>
			<!-- UY END -->


		</div>


	</main>
	
	<div class="fbtn-container">
		<div class="fbtn-inner">
			<a class="fbtn fbtn-lg fbtn-brand-accent waves-attach waves-circle waves-light" data-toggle="dropdown">
				<span class="fbtn-text fbtn-text-left">Home</span>
				<span class="fbtn-ori icon">apps</span>
				<span class="fbtn-sub icon">close</span>
			</a>
			<div class="fbtn-dropup">
				<a class="fbtn waves-attach waves-circle" href="/about.html" target="_blank">
					<span class="fbtn-text fbtn-text-left">关于作者</span><span class="icon">perm_identity</span>
				</a>
				<a class="fbtn waves-attach waves-circle" href="https://coding.net/u/ruanxingzhi/p/blog/topic" target="_blank">
					<span class="fbtn-text fbtn-text-left">反馈</span><span class="icon">feedback</span>
				</a>
				<a class="fbtn fbtn-green waves-attach waves-circle" href="/" target="_self">
					<span class="fbtn-text fbtn-text-left">返回主页</span><span class="icon">home</span>
				</a>
			</div>
		</div>
	</div>

	

	<!-- js -->
	<script src="/js/jquery.min.js"></script>
	<script src="/js/base.min.js"></script>
</body>
</html>