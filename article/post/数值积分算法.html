<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<title>数值积分算法 - blue's blog</title>

	<!-- css -->
	<link href="/css/base.min.css" rel="stylesheet">
	<link href="/css/project.min.css" rel="stylesheet">
	<link href="/css/styles.css" rel="stylesheet">


	<script type="text/x-mathjax-config">
  		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body class="page-brand">
	
	<nav class="menu menu-left nav-drawer nav-drawer-md" id="ui_menu">
		<div class="menu-scroll">
			<div class="menu-content">
				<a class="menu-logo" href="/">blue的博客</a>
				<ul class="nav">
					<li>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#posts">OI笔记</a>	
						<ul class="menu-collapse collapse in" id="posts">
							
							<li>
								<a class="waves-attach" href="/post/特征方程.html">特征方程教程</a>
							</li><li>
								<a class="waves-attach" href="/post/近似算法.html">近似算法</a>
							</li><li>
								<a class="waves-attach" href="/post/SG函数.html">SG函数</a>
							</li><li>
								<a class="waves-attach" href="/post/Matrix-Tree.html">Matrix-Tree定理</a>
							</li><li>
								<a class="waves-attach" href="/post/polya.html">polya定理</a>
							</li><li>
								<a class="waves-attach" href="/post/NOIP2016.html">NOIP2016游记</a>
							</li><li>
								<a class="waves-attach" href="/post/有限微积分.html">差分与有限微积分</a>
							</li><li>
								<a class="waves-attach" href="/post/概率论.html">概率论</a>
							</li><li>
								<a class="waves-attach" href="/post/博弈论.html">博弈论入门</a>
							</li><li>
								<a class="waves-attach" href="/post/级数相关.html">级数相关</a>
							</li><li>
								<a class="waves-attach" href="/post/母函数.html">浅谈母函数</a>
							</li><li>
								<a class="waves-attach" href="/post/FFT.html">FFT入门</a>
							</li><li>
								<a class="waves-attach" href="/post/三分查找.html">三分查找</a>
							</li><li>
								<a class="waves-attach" href="/post/Miller_Rabin.html">Miller_Rabin判素</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round4酱油记.html">HNSDFZ#4 酱油记</a>
							</li><li>
								<a class="waves-attach" href="/post/牛顿迭代.html">牛顿迭代法</a>
							</li><li>
								<a class="waves-attach" href="/post/泰勒展开.html">泰勒展开</a>
							</li><li>
								<a class="waves-attach" href="/post/狄利克雷卷积.html">狄利克雷卷积</a>
							</li><li>
								<a class="waves-attach" href="/post/单调队列.html">单调队列</a>
							</li><li class="active">
								<a class="waves-attach" href="/post/数值积分算法.html">数值积分算法</a>
							</li><li>
								<a class="waves-attach" href="/post/字符串hash.html">字符串hash</a>
							</li><li>
								<a class="waves-attach" href="/post/MEET-IN-THE-MIDDLE.html">Meet in the Middle</a>
							</li><li>
								<a class="waves-attach" href="/post/定积分.html">定积分与牛顿-莱布尼兹公式</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round3胡策记.html">HNSDFZ#3 胡策记</a>
							</li><li>
								<a class="waves-attach" href="/post/数学归纳法.html">数学归纳法</a>
							</li><li>
								<a class="waves-attach" href="/post/导数.html">导数</a>
							</li><li>
								<a class="waves-attach" href="/post/普通线段树.html">普通线段树</a>
							</li><li>
								<a class="waves-attach" href="/post/矩阵与递推.html">矩阵与递推</a>
							</li>						</ul>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#hack">渗透日志</a>	
						<ul class="menu-collapse collapse in" id="hack">
							
							<li>
								<a class="waves-attach" href="/hack/XSS.html">初探XSS</a>
							</li>						</ul>

					</li>
					
				</ul>
			</div>
		</div>
	</nav>
	<header class="header header-transparent header-waterfall ui-header">
		<ul class="nav nav-list pull-left hidden-md hidden-lg">
			<li>
				<a data-toggle="menu" href="#ui_menu">
					<span class="icon icon-lg">menu</span>
				</a>
			</li>
		</ul>
		<span class="header-logo header-affix visible-md-block visible-lg-block margin-right-no" data-offset-top="0" data-spy="affix">
			<p class="pagetitle">数值积分算法</p>
		</span>
		
		<ul class="nav nav-list pull-right">
			<li>
				<a data-toggle="menu" href="/">
					<span class="avatar avatar-sm"><img alt="blue" src="https://i.loli.net/2017/10/21/59eb6654682d2.png"></span>
				</a>
			</li>
		</ul>
	</header>
	<main class="content">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<br>
						
<h1>数值积分</h1>
<div class="card"><div class="card-main"><div class="card-inner">
<p>靠，除了刘汝佳的书和一些人的博客，什么中文资料都找不到</p>
</div></div></div>
<p>定积分真是迷人……
有时可以算出原函数，有的时候算不出来原函数。（俗称“积不出来”）</p>
<p>我们需要一些求积分的方法——数值积分算法。</p>
<h2>牛顿-莱布尼茨公式</h2>
<p>应用于我们能容易地算出<mathjax>$f(x)$</mathjax>的原函数的情况。往往是多项式函数。</p>
<div class="codehilite"><pre><span></span><span class="kt">float</span> <span class="nf">F</span><span class="p">(</span><span class="kt">float</span> <span class="n">x</span><span class="p">)</span>                <span class="c1">//已经计算出F(x)为f(x)的导函数</span>
<span class="p">{</span>
    <span class="k">return</span> <span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">float</span> <span class="nf">integral</span><span class="p">(</span><span class="kt">float</span> <span class="n">a</span><span class="p">,</span><span class="kt">float</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>                               
    <span class="k">return</span> <span class="n">F</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="o">-</span><span class="n">F</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>           <span class="c1">//基本定理</span>
<span class="p">}</span>
</pre></div>


<h2>拉格朗日中值定理</h2>
<p>对求积分也没什么用……</p>
<p>如果<mathjax>$f(x)$</mathjax>满足：
1. 在闭区间<mathjax>$[a,b]$</mathjax>上连续；
2. 在开区间<mathjax>$(a,b)$</mathjax>上可导。</p>
<p>那么开区间<mathjax>$(a,b)$</mathjax>中至少有一点<mathjax>$\varepsilon$</mathjax>，使得<mathjax>$f(b)-f(a)=f\prime(\varepsilon)(b-a)$</mathjax>。</p>
<h2>辛普森公式</h2>
<p>辛普森公式用于求我们<strong>很难求原函数</strong>的函数的积分。</p>
<p>很玄学的公式：
<mathjax>$\int_{a}^{b} f(x) \, dx \approx \frac{b-a}{6}\left[f(a) + 4f\left(\frac{a+b}{2}\right)+f(b)\right]$</mathjax></p>
<p>大意是：选取在<mathjax>$x=a$</mathjax>、<mathjax>$x=\frac{a+b}{2}$</mathjax>和<mathjax>$x=b$</mathjax>，拿二次函数来拟合这三个点。
当然，这样搞精度误差很大。解决的方法是，<strong>把<mathjax>$[a,b]$</mathjax>分割成很多个区段，对每个区段用辛普森公式求积分。</strong>
区段的个数由要求的精度确定。（我喜欢取<mathjax>$233$</mathjax>段</p>
<h2>自适应辛普森算法</h2>
<p>Adaptive Simpson's method。这个东西中文资料少得可怜……</p>
<p>具体的方法是，改<strong>每隔<mathjax>$\Delta x$</mathjax>取一个区段</strong>为<strong>智能地</strong>取区段。
如何让程序智能起来？容易脑补，如果某段区间容易拟合上，那就少取几段；如果难以拟合，就多取几段。</p>
<p>如何衡量是否“容易拟合”？上面的辛普森公式给了很好的方案。
令<mathjax>$Sim(le,rt)$</mathjax>为辛普森公式所求出的答案。那么：</p>
<div class="card"><div class="card-main"><div class="card-inner">
<ol>
<li>如果<mathjax>$Sim(a,mid)+Sim(mid,b)-Sim(a,b) &lt; \gamma$</mathjax><br />
则这一块<strong>可以</strong>很好地拟合上，返回<mathjax>$Sim(a,mid)+Sim(mid,b)$</mathjax>；  </li>
<li>如果<mathjax>$Sim(a,mid)+Sim(mid,b)-Sim(a,b) ≥ \gamma$</mathjax><br />
则这一块<strong>不能</strong>很好地拟合上，递归处理<mathjax>$(a,mid)$</mathjax>和<mathjax>$(mid,b)$</mathjax>。  </li>
</ol>
</div></div></div>
<p>上面的方法很容易理解。如果<mathjax>$(a,b)$</mathjax>可以很好地被拟合，那么<mathjax>$Sim(a,mid)+Sim(mid,b)$</mathjax>应该和<mathjax>$Sim(a,b)$</mathjax>相差无几。</p>
<p>如果函数难以拟合，那么我们就需要多次拟合，来计算出<strong>尽可能</strong>准确的结果。所以，这个算法是“自适应”的。</p>
<p>精度比之前的普通辛普森算法好得多。</p>
<h2>拉格朗日插值法</h2>
<p>拉格朗日插值法求积分的原理是，<strong>以多项式来拟合被积函数，然后积多项式</strong>。</p>
<p>拉格朗日插值法：给定<mathjax>$n$</mathjax>个点，拟合出一条多项式函数，过这些点。</p>
<p>由于我们可以选择很多个点，因此多项式可以做得与原函数<strong>相当接近</strong>。同时，多项式函数很容易求导，所以也容易求积分。精度有保障。</p>
<p>时间复杂度：找到<mathjax>$n$</mathjax>个点用时<mathjax>$O(n)$</mathjax>，插值<mathjax>$O(n^2)$</mathjax>，求导<mathjax>$O(n)$</mathjax>，求积分<mathjax>$O(n)$</mathjax>。
当然，如果你懒得写拉格朗日插值法，高斯消元也可以，但是插值的复杂度就变成<mathjax>$O(n^3)$</mathjax>。</p>
<p>（其实我觉得拉格朗日插值法比高斯消元好写多了……</p>
<p>附上《拉格朗日插值法》的文档：<a href="http://ruanxingzhi.coding.me/File/%E6%96%87%E6%A1%A3/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E6%8F%92%E5%80%BC%E6%B3%95.pdf">拉格朗日插值法.pdf</a></p>
<hr />
<p>update on 2016.8.31</p>
<p>另一种思路。  </p>
<h2>泰勒展开求积分</h2>
<p>如果我们遇到的函数可以泰勒展开（例如<mathjax>$e^x$</mathjax>，<mathjax>$\sin(x)$</mathjax>之类的函数），那么我们可以将它展开成一个多项式，然后直接用多项式的积分方法来求解。  </p>
<p>例如，如果我们要求<mathjax>$f(x)=\sin (x)$</mathjax>的积分，我们先把它在<mathjax>$O(n)$</mathjax>内展开成<mathjax>$\displaystyle f(x)=x - \frac{x^3}{3!}+\frac{x^5}{5!} - \frac{x^7}{7!}+\cdots$</mathjax>，然后在<mathjax>$O(n)$</mathjax>内求出对应的原函数<mathjax>$F(x)$</mathjax>，然后在<mathjax>$O(n)$</mathjax>内用霍纳法则求出<mathjax>$F(l)$</mathjax>和<mathjax>$F(r)$</mathjax>的值。</p>
						
					</section>
				</div>
			</div>

			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<hr>
						
							CC0协议 @ ruanxingzhi 2017.
						<a style="float:right" href="/CC0.html">CC0是啥玩意?</a>
					</section>
				</div>
			</div>

			<!-- UY BEGIN -->
			<div id="uyan_frame"></div>
			<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128300"></script>
			<!-- UY END -->


		</div>


	</main>
	
	<div class="fbtn-container">
		<div class="fbtn-inner">
			<a class="fbtn fbtn-lg fbtn-brand-accent waves-attach waves-circle waves-light" data-toggle="dropdown">
				<span class="fbtn-text fbtn-text-left">Home</span>
				<span class="fbtn-ori icon">apps</span>
				<span class="fbtn-sub icon">close</span>
			</a>
			<div class="fbtn-dropup">
				<a class="fbtn waves-attach waves-circle" href="/about.html" target="_blank">
					<span class="fbtn-text fbtn-text-left">关于作者</span><span class="icon">perm_identity</span>
				</a>
				<a class="fbtn waves-attach waves-circle" href="https://coding.net/u/ruanxingzhi/p/blog/topic" target="_blank">
					<span class="fbtn-text fbtn-text-left">反馈</span><span class="icon">feedback</span>
				</a>
				<a class="fbtn fbtn-green waves-attach waves-circle" href="/" target="_self">
					<span class="fbtn-text fbtn-text-left">返回主页</span><span class="icon">home</span>
				</a>
			</div>
		</div>
	</div>

	

	<!-- js -->
	<script src="/js/jquery.min.js"></script>
	<script src="/js/base.min.js"></script>
</body>
</html>