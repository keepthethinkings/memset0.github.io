<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<title>差分与有限微积分 - blue's blog</title>

	<!-- css -->
	<link href="/css/base.min.css" rel="stylesheet">
	<link href="/css/project.min.css" rel="stylesheet">
	<link href="/css/styles.css" rel="stylesheet">


	<script type="text/x-mathjax-config">
  		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body class="page-brand">
	
	<nav class="menu menu-left nav-drawer nav-drawer-md" id="ui_menu">
		<div class="menu-scroll">
			<div class="menu-content">
				<a class="menu-logo" href="/">blue的博客</a>
				<ul class="nav">
					<li>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#posts">OI笔记</a>	
						<ul class="menu-collapse collapse in" id="posts">
							
							<li>
								<a class="waves-attach" href="/post/特征方程.html">特征方程教程</a>
							</li><li>
								<a class="waves-attach" href="/post/近似算法.html">近似算法</a>
							</li><li>
								<a class="waves-attach" href="/post/SG函数.html">SG函数</a>
							</li><li>
								<a class="waves-attach" href="/post/Matrix-Tree.html">Matrix-Tree定理</a>
							</li><li>
								<a class="waves-attach" href="/post/polya.html">polya定理</a>
							</li><li>
								<a class="waves-attach" href="/post/NOIP2016.html">NOIP2016游记</a>
							</li><li class="active">
								<a class="waves-attach" href="/post/有限微积分.html">差分与有限微积分</a>
							</li><li>
								<a class="waves-attach" href="/post/概率论.html">概率论</a>
							</li><li>
								<a class="waves-attach" href="/post/博弈论.html">博弈论入门</a>
							</li><li>
								<a class="waves-attach" href="/post/级数相关.html">级数相关</a>
							</li><li>
								<a class="waves-attach" href="/post/母函数.html">浅谈母函数</a>
							</li><li>
								<a class="waves-attach" href="/post/FFT.html">FFT入门</a>
							</li><li>
								<a class="waves-attach" href="/post/三分查找.html">三分查找</a>
							</li><li>
								<a class="waves-attach" href="/post/Miller_Rabin.html">Miller_Rabin判素</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round4酱油记.html">HNSDFZ#4 酱油记</a>
							</li><li>
								<a class="waves-attach" href="/post/牛顿迭代.html">牛顿迭代法</a>
							</li><li>
								<a class="waves-attach" href="/post/泰勒展开.html">泰勒展开</a>
							</li><li>
								<a class="waves-attach" href="/post/狄利克雷卷积.html">狄利克雷卷积</a>
							</li><li>
								<a class="waves-attach" href="/post/单调队列.html">单调队列</a>
							</li><li>
								<a class="waves-attach" href="/post/数值积分算法.html">数值积分算法</a>
							</li><li>
								<a class="waves-attach" href="/post/字符串hash.html">字符串hash</a>
							</li><li>
								<a class="waves-attach" href="/post/MEET-IN-THE-MIDDLE.html">Meet in the Middle</a>
							</li><li>
								<a class="waves-attach" href="/post/定积分.html">定积分与牛顿-莱布尼兹公式</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round3胡策记.html">HNSDFZ#3 胡策记</a>
							</li><li>
								<a class="waves-attach" href="/post/数学归纳法.html">数学归纳法</a>
							</li><li>
								<a class="waves-attach" href="/post/导数.html">导数</a>
							</li><li>
								<a class="waves-attach" href="/post/普通线段树.html">普通线段树</a>
							</li><li>
								<a class="waves-attach" href="/post/矩阵与递推.html">矩阵与递推</a>
							</li>						</ul>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#hack">渗透日志</a>	
						<ul class="menu-collapse collapse in" id="hack">
							
							<li>
								<a class="waves-attach" href="/hack/XSS.html">初探XSS</a>
							</li>						</ul>

					</li>
					
				</ul>
			</div>
		</div>
	</nav>
	<header class="header header-transparent header-waterfall ui-header">
		<ul class="nav nav-list pull-left hidden-md hidden-lg">
			<li>
				<a data-toggle="menu" href="#ui_menu">
					<span class="icon icon-lg">menu</span>
				</a>
			</li>
		</ul>
		<span class="header-logo header-affix visible-md-block visible-lg-block margin-right-no" data-offset-top="0" data-spy="affix">
			<p class="pagetitle">差分与有限微积分</p>
		</span>
		
		<ul class="nav nav-list pull-right">
			<li>
				<a data-toggle="menu" href="/">
					<span class="avatar avatar-sm"><img alt="blue" src="https://i.loli.net/2017/10/21/59eb6654682d2.png"></span>
				</a>
			</li>
		</ul>
	</header>
	<main class="content">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<br>
						
<h1>差分与有限微积分</h1>
<div class="card"><div class="card-main"><div class="card-inner">
<p>阅读这篇文章需要微积分基础。  <br />
从《具体数学》上看来的，感觉十分有用。  <br />
为了思维的连贯性，省略了大量细节。这些细节将在最后补充。  </p>
</div></div></div>
<h2>差分算子</h2>
<p>首先，有一个关于“算子”的定义：  </p>
<div class="card"><div class="card-main"><div class="card-inner">
<p>如果一个运算作用在函数上，则我们称这个运算为“算子”。</p>
</div></div></div>
<p>显然，多项式的卷积、狄利克雷卷积等都是算子。 <br />
在迈入高等数学的大门时，我们遇到过一个强劲的算子：<strong>微分算子</strong>。</p>
<p>微分算子<mathjax>$\text D$</mathjax>是这样定义的：<mathjax>$\text Df(x) = \displaystyle \lim _{h \to 0}\frac{f(x + h)-f(x)}{h}$</mathjax>.它的几何意义是，对于某个<mathjax>$x$</mathjax>，以 (<mathjax>$x$</mathjax>加上无穷小) 处的函数值减去<mathjax>$x$</mathjax>的函数值。    <br />
因此，<mathjax>$\text Df(x)$</mathjax>就是<mathjax>$f(x)$</mathjax>的导函数。</p>
<p>由于微分算子使用了<code>无穷小</code>，所以微分算子用于<strong>连续数学</strong>。但是对于别的函数——它们只能在整数范围内取值，微分算子就无法通用。  </p>
<p>面对<strong>离散数学</strong>，定义差分算子<mathjax>$\Delta$</mathjax>：<mathjax>$\displaystyle \Delta f(x)= f(x+1)-f(x)$</mathjax>.</p>
<p>它的几何意义如图：<br />
<img style="max-width:100%" alt="差分" src="https://i4.piimg.com/567571/a8ae6944ab0ee08e.png" /></p>
<p>容易看出，<strong>差分算子给出相邻的整数之间函数值的差。</strong></p>
<h2>有限微积分</h2>
<p>众所周知，微分里有一个很妙的公式：<mathjax>$\text D(x^m)=m\cdot x^{m-1}$</mathjax>.<br />
差分有没有类似的公式呢？</p>
<p>来考虑下降阶乘幂：<mathjax>$x^{\underline m} = x \cdot (x-1) \cdot (x-2)\cdots (x-m+1)$</mathjax>.<br />
手推一番，我们发现<mathjax>$\Delta(x^{\underline m})=m\cdot x^{\underline {m-1}}$</mathjax>.  <br />
惊喜的是，差分的运算法则和微分的运算法则如出一辙。例如<mathjax>$\text Df(x)+\text Dg(x)=\text D(f(x)+g(x))$</mathjax>之类的导数运算，<strong>都可以直接套在差分上</strong>。</p>
<p>有什么用？</p>
<p>牛顿-莱布尼茨公式：若<mathjax>$g(x)=\text Df(x)$</mathjax>，则有<mathjax>$\displaystyle \int _a ^b g(x) = f(b) - f(a)$</mathjax>.
类似积分，可以构造出和式：  </p>
<p>首先，我们令<mathjax>$\textstyle \sum _a^bf(x)=\displaystyle \sum_{i=a}^{b-1}f(x)$</mathjax>.<strong>注意两个<mathjax>$\Sigma$</mathjax>之间的区别。</strong></p>
<p>那么有基本定理：  </p>
<div class="card"><div class="card-main"><div class="card-inner">
<p>如果<mathjax>$g(x)=\Delta f(x)$</mathjax>,则有<mathjax>$\textstyle \sum_a^b g(x) = f(b)-f(a)$</mathjax>.</p>
</div></div></div>
<p>如何理解这个公式？举个例子。假设我们找到了<mathjax>$g(x)=\Delta f(x)$</mathjax>，那么我们可以快速求：<br />
<mathjax>$\displaystyle \sum_{i=1}^{n} g(x) =\textstyle \sum_{1}^{n+1}g(x)=f(n+1)-f(1)$</mathjax>.</p>
<p>回到之前讨论的下降阶乘幂。我们有<mathjax>$\Delta(x^{\underline m})=m\cdot x^{\underline {m-1}}$</mathjax>.<br />
所以实践中，可以直接用下降阶乘幂来解决问题。</p>
<h2>例子</h2>
<p>求<mathjax>$\displaystyle \sum_{i=0}^{100}x^2$</mathjax>.</p>
<p>首先，我们把<mathjax>$x^2$</mathjax>表示成下降阶乘幂的形式。稍加计算得到：<mathjax>$g(x)=x^2=x(x-1)+x=x^{\underline 2}+x^{\underline 1}$</mathjax>.</p>
<p>然后构造<mathjax>$g(x)$</mathjax>的原函数：<mathjax>$f(x)=\frac{1}{3}x^{\underline 3}+\frac{1}{2}x^{\underline 2}=\frac{x(x-1)(x-2)}{3}+\frac{x(x-1)}{2}$</mathjax>.</p>
<p>于是有：<mathjax>$\displaystyle \sum_{i=0}^{100}x^2 = \textstyle \sum^{101}_0g(x)=f(101)-f(0)=\frac{101\cdot 100 \cdot 99}{3}+\frac{101 \cdot 100}{2} =338350$</mathjax>.</p>
<p>这就是<strong>有限微积分</strong>。</p>
<h2>一个例题</h2>
<p>求<mathjax>$1^k + 2^k + 3^k \cdots + n^k$</mathjax>.</p>
<p><mathjax>$n&lt;1000 , k&lt;1000$</mathjax><br />
暴力。</p>
<p><mathjax>$n&lt;100000,k&lt;1000000$</mathjax>  <br />
快速幂。</p>
<p><mathjax>$n&lt;10^8 , k&lt;10$</mathjax><br />
先写个程序推出<mathjax>$x^k$</mathjax>的下降阶乘幂形式，然后用有限微积分<mathjax>$O(1)$</mathjax>做。</p>
<p><mathjax>$n&lt;10^8 , k&lt;1000$</mathjax> <br />
从有限微积分中可以知道，答案一定是一个<mathjax>$k+1$</mathjax>阶多项式。</p>
<p>故先<mathjax>$O(n \log k)$</mathjax>求出<mathjax>$n=1 ,2,3\cdots k+1$</mathjax>时的答案，然后<mathjax>$O(k^2)$</mathjax>插值回多项式(拉格朗日插值法)，然后<mathjax>$O(k)$</mathjax>计算答案(霍纳法则)。<br />
总复杂度<mathjax>$O(k^2)$</mathjax>.</p>
<p><mathjax>$n&lt;=10^8 , k&lt;10^5$</mathjax><br />
orz Gromah.</p>
<h2>几个细节</h2>
<p><strong>差分表</strong></p>
<table class="table">
<thead>
<tr>
<th>原函数<mathjax>$f(x)$</mathjax></th>
<th>差分函数<mathjax>$\Delta f(x)$</mathjax></th>
</tr>
</thead>
<tbody>
<tr>
<td><mathjax>$x^\underline m$</mathjax></td>
<td><mathjax>$m\cdot x^\underline {m-1}$</mathjax></td>
</tr>
<tr>
<td><mathjax>$2^x$</mathjax></td>
<td><mathjax>$2^x$</mathjax></td>
</tr>
<tr>
<td><mathjax>$c^x$</mathjax></td>
<td><mathjax>$(c-1)c^x$</mathjax></td>
</tr>
</tbody>
</table>
<p><strong>差分运算法则</strong><br />
下面的向量代表函数。</p>
<table class="table">
<thead>
<tr>
<th>原函数<mathjax>$f(x)$</mathjax></th>
<th>差分函数<mathjax>$\Delta f(x)$</mathjax></th>
</tr>
</thead>
<tbody>
<tr>
<td><mathjax>$c\cdot \vec u$</mathjax></td>
<td><mathjax>$c \cdot  \Delta\vec u$</mathjax></td>
</tr>
<tr>
<td><mathjax>$\vec u + \vec v$</mathjax></td>
<td><mathjax>$\Delta \vec u + \Delta \vec v$</mathjax></td>
</tr>
</tbody>
</table>
<p><strong>序列差分</strong></p>
<p>考虑一个序列的差分：
<mathjax>$\{a_1,a_2,a_3\cdots \}\leftrightarrow\{a_2-a_1,a_3-a_2,\cdots\}$</mathjax>  <br />
记一阶差分的结果为<mathjax>$\vec b$</mathjax>，对<mathjax>$\vec b$</mathjax>再做一次差分，得到二阶差分：<br />
<mathjax>$\{b_2-b_1,b_3-b_2,\cdots\}$</mathjax>  </p>
<p>如果这个初始序列由<mathjax>$f(1),f(2)\cdots$</mathjax>给出，则有：  <br />
如果<mathjax>$f(x)$</mathjax>是<mathjax>$k$</mathjax>次多项式，那么<mathjax>$\vec a$</mathjax>的<mathjax>$k+1$</mathjax>阶差分全部相等，<mathjax>$k+2$</mathjax>阶差分全为<mathjax>$0$</mathjax>.</p>
<p>例如：<mathjax>$f(x)=x^3$</mathjax></p>
<div class="codehilite"><pre><span></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">125</span><span class="p">)</span>    <span class="o">-&gt;</span>
<span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">61</span><span class="p">)</span>        <span class="o">-&gt;</span>
<span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">24</span><span class="p">)</span>           <span class="o">-&gt;</span>
<span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>                 <span class="o">-&gt;</span>
<span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>


<p><strong>负指数下降幂</strong></p>
<p>定义<mathjax>$x^{-\underline m} , m \in Z_+$</mathjax>为：<br />
<mathjax>$x^{-\underline m} = \frac{1}{(x+1)\cdot (x+2)\cdot (x+3)\cdots}$</mathjax></p>
						
					</section>
				</div>
			</div>

			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<hr>
						
							CC0协议 @ ruanxingzhi 2017.
						<a style="float:right" href="/CC0.html">CC0是啥玩意?</a>
					</section>
				</div>
			</div>

			<!-- UY BEGIN -->
			<div id="uyan_frame"></div>
			<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128300"></script>
			<!-- UY END -->


		</div>


	</main>
	
	<div class="fbtn-container">
		<div class="fbtn-inner">
			<a class="fbtn fbtn-lg fbtn-brand-accent waves-attach waves-circle waves-light" data-toggle="dropdown">
				<span class="fbtn-text fbtn-text-left">Home</span>
				<span class="fbtn-ori icon">apps</span>
				<span class="fbtn-sub icon">close</span>
			</a>
			<div class="fbtn-dropup">
				<a class="fbtn waves-attach waves-circle" href="/about.html" target="_blank">
					<span class="fbtn-text fbtn-text-left">关于作者</span><span class="icon">perm_identity</span>
				</a>
				<a class="fbtn waves-attach waves-circle" href="https://coding.net/u/ruanxingzhi/p/blog/topic" target="_blank">
					<span class="fbtn-text fbtn-text-left">反馈</span><span class="icon">feedback</span>
				</a>
				<a class="fbtn fbtn-green waves-attach waves-circle" href="/" target="_self">
					<span class="fbtn-text fbtn-text-left">返回主页</span><span class="icon">home</span>
				</a>
			</div>
		</div>
	</div>

	

	<!-- js -->
	<script src="/js/jquery.min.js"></script>
	<script src="/js/base.min.js"></script>
</body>
</html>