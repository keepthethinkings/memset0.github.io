<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta content="IE=edge" http-equiv="X-UA-Compatible">
	<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=no, width=device-width" name="viewport">
	<title>polya定理 - blue's blog</title>

	<!-- css -->
	<link href="/css/base.min.css" rel="stylesheet">
	<link href="/css/project.min.css" rel="stylesheet">
	<link href="/css/styles.css" rel="stylesheet">


	<script type="text/x-mathjax-config">
  		MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
	</script>
	<script src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</head>
<body class="page-brand">
	
	<nav class="menu menu-left nav-drawer nav-drawer-md" id="ui_menu">
		<div class="menu-scroll">
			<div class="menu-content">
				<a class="menu-logo" href="/">blue的博客</a>
				<ul class="nav">
					<li>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#posts">OI笔记</a>	
						<ul class="menu-collapse collapse in" id="posts">
							
							<li>
								<a class="waves-attach" href="/post/特征方程.html">特征方程教程</a>
							</li><li>
								<a class="waves-attach" href="/post/近似算法.html">近似算法</a>
							</li><li>
								<a class="waves-attach" href="/post/SG函数.html">SG函数</a>
							</li><li>
								<a class="waves-attach" href="/post/Matrix-Tree.html">Matrix-Tree定理</a>
							</li><li class="active">
								<a class="waves-attach" href="/post/polya.html">polya定理</a>
							</li><li>
								<a class="waves-attach" href="/post/NOIP2016.html">NOIP2016游记</a>
							</li><li>
								<a class="waves-attach" href="/post/有限微积分.html">差分与有限微积分</a>
							</li><li>
								<a class="waves-attach" href="/post/概率论.html">概率论</a>
							</li><li>
								<a class="waves-attach" href="/post/博弈论.html">博弈论入门</a>
							</li><li>
								<a class="waves-attach" href="/post/级数相关.html">级数相关</a>
							</li><li>
								<a class="waves-attach" href="/post/母函数.html">浅谈母函数</a>
							</li><li>
								<a class="waves-attach" href="/post/FFT.html">FFT入门</a>
							</li><li>
								<a class="waves-attach" href="/post/三分查找.html">三分查找</a>
							</li><li>
								<a class="waves-attach" href="/post/Miller_Rabin.html">Miller_Rabin判素</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round4酱油记.html">HNSDFZ#4 酱油记</a>
							</li><li>
								<a class="waves-attach" href="/post/牛顿迭代.html">牛顿迭代法</a>
							</li><li>
								<a class="waves-attach" href="/post/泰勒展开.html">泰勒展开</a>
							</li><li>
								<a class="waves-attach" href="/post/狄利克雷卷积.html">狄利克雷卷积</a>
							</li><li>
								<a class="waves-attach" href="/post/单调队列.html">单调队列</a>
							</li><li>
								<a class="waves-attach" href="/post/数值积分算法.html">数值积分算法</a>
							</li><li>
								<a class="waves-attach" href="/post/字符串hash.html">字符串hash</a>
							</li><li>
								<a class="waves-attach" href="/post/MEET-IN-THE-MIDDLE.html">Meet in the Middle</a>
							</li><li>
								<a class="waves-attach" href="/post/定积分.html">定积分与牛顿-莱布尼兹公式</a>
							</li><li>
								<a class="waves-attach" href="/post/HNSDFZ-Round3胡策记.html">HNSDFZ#3 胡策记</a>
							</li><li>
								<a class="waves-attach" href="/post/数学归纳法.html">数学归纳法</a>
							</li><li>
								<a class="waves-attach" href="/post/导数.html">导数</a>
							</li><li>
								<a class="waves-attach" href="/post/普通线段树.html">普通线段树</a>
							</li><li>
								<a class="waves-attach" href="/post/矩阵与递推.html">矩阵与递推</a>
							</li>						</ul>

						<a class="collapsed waves-attach waves-effect" data-toggle="collapse" href="#hack">渗透日志</a>	
						<ul class="menu-collapse collapse in" id="hack">
							
							<li>
								<a class="waves-attach" href="/hack/XSS.html">初探XSS</a>
							</li>						</ul>

					</li>
					
				</ul>
			</div>
		</div>
	</nav>
	<header class="header header-transparent header-waterfall ui-header">
		<ul class="nav nav-list pull-left hidden-md hidden-lg">
			<li>
				<a data-toggle="menu" href="#ui_menu">
					<span class="icon icon-lg">menu</span>
				</a>
			</li>
		</ul>
		<span class="header-logo header-affix visible-md-block visible-lg-block margin-right-no" data-offset-top="0" data-spy="affix">
			<p class="pagetitle">polya定理</p>
		</span>
		
		<ul class="nav nav-list pull-right">
			<li>
				<a data-toggle="menu" href="/">
					<span class="avatar avatar-sm"><img alt="blue" src="https://i.loli.net/2017/10/21/59eb6654682d2.png"></span>
				</a>
			</li>
		</ul>
	</header>
	<main class="content">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<br>
						
<h1>polya定理</h1>
<div class="card"><div class="card-main"><div class="card-inner">
<p>这是组合数学中著名的定理。用于解决“本质不同的染色方案”计数问题。</p>
</div></div></div>
<h2>问题</h2>
<p>现在需要给<mathjax>$2 \times 2$</mathjax>的棋盘黑白染色。求本质不同的染色方案数。</p>
<p>如果某染色方案经过<strong>顺时针旋转</strong>后与别的染色方案相同，则称它们本质相同。</p>
<h2>暴力</h2>
<p>我们先暴力列出每种染色方案：
<img style="max-width:100%" alt="每种方案" src="https://p1.bpimg.com/567571/3c1b9b1dedbc975c.png" /></p>
<p>发现本质不同的染色方案数有<mathjax>$6$</mathjax>种：<code>C1,C2,C6,C10,C12,C16</code>。</p>
<h2>burnside引理</h2>
<p>burnside引理是polya定理的基础。</p>
<p>为了讨论方便，先给格子编号。<br />
<img style="max-width:100%" alt="编号" src="https://p1.bpimg.com/567571/f2f2b36b925b8b8d.png" />  </p>
<p>首先考虑“旋转”的本质——置换。旋转给出了一些置换方式，例如顺时针旋转<mathjax>$90^\circ$</mathjax>，用置换的语言说就是“原来的位置是<code>1</code>的现在摆在<code>2</code>，原来位置是<code>2</code>的现在摆在<code>3</code>……”，表示为<mathjax>$\{2,3,4,1\}$</mathjax>。类似地，我们搞出所有的置换：</p>
<p><mathjax>$f_{0^\circ} = \{1,2,3,4\}$</mathjax><br />
<mathjax>$f_{90^\circ} = \{2,3,4,1\}$</mathjax><br />
<mathjax>$f_{180^\circ} = \{3,4,1,2\}$</mathjax><br />
<mathjax>$f_{270^\circ} = \{4,1,2,3\}$</mathjax>  </p>
<p>接下来就是<code>burnside引理</code>了：</p>
<div class="card"><div class="card-main"><div class="card-inner">
<p>对于每个置换<mathjax>$f$</mathjax>，我们定义<mathjax>$C(f)$</mathjax>为<strong>在置换 <mathjax>$f$</mathjax> 下保持不变的方案数</strong>。<br />
则有： 本质不同的方案数为<mathjax>$C(f)$</mathjax>的<strong>平均数</strong>。<br />
即：<mathjax>$\displaystyle \text{ans} = \frac{1}{|G|} \sum_{f \in G} C(f)$</mathjax></p>
</div></div></div>
<p>用上面的例子来验证一下：</p>
<table class="table">
<thead>
<tr>
<th>置换<mathjax>$f$</mathjax></th>
<th>保持不变的方案</th>
<th><mathjax>$C(f)$</mathjax></th>
</tr>
</thead>
<tbody>
<tr>
<td><mathjax>${0^\circ}$</mathjax></td>
<td>1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16</td>
<td>16</td>
</tr>
<tr>
<td><mathjax>${90^\circ}$</mathjax></td>
<td>1,16</td>
<td>2</td>
</tr>
<tr>
<td><mathjax>${180^\circ}$</mathjax></td>
<td>1,10,11,16</td>
<td>4</td>
</tr>
<tr>
<td><mathjax>${270^\circ}$</mathjax></td>
<td>1,16</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>则<mathjax>$C(f)$</mathjax>的平均数为：<mathjax>$\frac{16+2+4+2}{4} = 6$</mathjax>，发现确实是答案。</p>
<h2>polya定理</h2>
<p>上面的<code>burnside引理</code>很好用，然而它需要枚举每个方案，复杂度十分不好。</p>
<p>所以<code>polya定理</code>出来拯救世界了。它提供了一种快速计算<mathjax>$C(f)$</mathjax>的方法：</p>
<p>考虑置换<mathjax>$f$</mathjax>，我们一定能把它表示成<strong>循环</strong>的形式。例如上面的转<mathjax>$180^\circ$</mathjax>可以表示为：<mathjax>$\{3,4,1,2\} = (1,3)(2,4)$</mathjax>。</p>
<p>令<mathjax>$m(f)$</mathjax>表示置换<mathjax>$f$</mathjax>的循环节个数，<mathjax>$k$</mathjax>表示有多少种颜色。则有：</p>
<p><mathjax>$\displaystyle C(f) = k^{m(f)}$</mathjax></p>
<p>我们还是使用之前的例子来验证。</p>
<table class="table">
<thead>
<tr>
<th>角度</th>
<th>置换</th>
<th><mathjax>$m(f)$</mathjax></th>
</tr>
</thead>
<tbody>
<tr>
<td><mathjax>${0^\circ}$</mathjax></td>
<td><mathjax>$\{1,2,3,4\} = (1)(2)(3)(4)$</mathjax></td>
<td><mathjax>$4$</mathjax></td>
</tr>
<tr>
<td><mathjax>${90^\circ}$</mathjax></td>
<td><mathjax>$\{2,3,4,1\} = (1,2,3,4)$</mathjax></td>
<td><mathjax>$1$</mathjax></td>
</tr>
<tr>
<td><mathjax>${180^\circ}$</mathjax></td>
<td><mathjax>$\{3,4,1,2\} = (1,3)(2,4)$</mathjax></td>
<td><mathjax>$2$</mathjax></td>
</tr>
<tr>
<td><mathjax>${270^\circ}$</mathjax></td>
<td><mathjax>$\{4,1,2,3\} = (1,2,3,4)$</mathjax></td>
<td><mathjax>$1$</mathjax></td>
</tr>
</tbody>
</table>
<p>从上面的例子中我们发现，<mathjax>$k^{m(f)}$</mathjax>确实等于<mathjax>$C(f)$</mathjax>。现在我们的任务只是求出<mathjax>$m(f)$</mathjax>了。它显然可以<mathjax>$O(n)$</mathjax>求出：</p>
<div class="codehilite"><pre><span></span><span class="kt">int</span> <span class="n">flag</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">},</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="mi">4</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="k">if</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> 
    <span class="p">{</span>
        <span class="n">j</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
        <span class="k">while</span><span class="p">(</span><span class="n">flag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">flag</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">j</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
        <span class="n">m</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
</pre></div>


<p>所以现在我们可以以<mathjax>$O(np)$</mathjax>的时间复杂度来求出整个问题的解。其中<mathjax>$p$</mathjax>表示置换数量。</p>
<p>是不是很简单？</p>
						
					</section>
				</div>
			</div>

			<div class="row">
				<div class="col-lg-6 col-lg-offset-3 col-md-10 col-md-offset-1">
					<section class="content-inner margin-top-no">
						<hr>
						
							CC0协议 @ ruanxingzhi 2017.
						<a style="float:right" href="/CC0.html">CC0是啥玩意?</a>
					</section>
				</div>
			</div>

			<!-- UY BEGIN -->
			<div id="uyan_frame"></div>
			<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128300"></script>
			<!-- UY END -->


		</div>


	</main>
	
	<div class="fbtn-container">
		<div class="fbtn-inner">
			<a class="fbtn fbtn-lg fbtn-brand-accent waves-attach waves-circle waves-light" data-toggle="dropdown">
				<span class="fbtn-text fbtn-text-left">Home</span>
				<span class="fbtn-ori icon">apps</span>
				<span class="fbtn-sub icon">close</span>
			</a>
			<div class="fbtn-dropup">
				<a class="fbtn waves-attach waves-circle" href="/about.html" target="_blank">
					<span class="fbtn-text fbtn-text-left">关于作者</span><span class="icon">perm_identity</span>
				</a>
				<a class="fbtn waves-attach waves-circle" href="https://coding.net/u/ruanxingzhi/p/blog/topic" target="_blank">
					<span class="fbtn-text fbtn-text-left">反馈</span><span class="icon">feedback</span>
				</a>
				<a class="fbtn fbtn-green waves-attach waves-circle" href="/" target="_self">
					<span class="fbtn-text fbtn-text-left">返回主页</span><span class="icon">home</span>
				</a>
			</div>
		</div>
	</div>

	

	<!-- js -->
	<script src="/js/jquery.min.js"></script>
	<script src="/js/base.min.js"></script>
</body>
</html>